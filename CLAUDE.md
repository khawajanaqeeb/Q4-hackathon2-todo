# Claude Code Agent Instructions - Phase I

This file contains instructions for AI agents (Claude Code) working on the Phase I Todo Console App.

## Project Context

**Hackathon**: Hackathon II - "The Evolution of Todo"
**Phase**: Phase I - In-Memory Python Console App
**Repository**: https://github.com/khawajanaqeeb/hackathon-todo
**Constitution**: F:\Q4-hakathons\Q4-hackathon2-todo\.specify\memory\constitution.md

## Core Principles (from Constitution)

### Article II: Spec-Driven Development (SDD) Mandate - NON-NEGOTIABLE

- **ALL code MUST be generated by Claude Code from refined specifications**
- **NO manual coding allowed**
- Development workflow: Constitution â†’ Spec â†’ Plan â†’ Tasks â†’ Implement
- Current stage: Implementation (executing tasks.md)

### Article IV: Technology Stack Constraints - PHASE I IMMUTABLE

```yaml
Language: Python 3.13+
Package Manager: UV
Storage: In-memory only (list/dict data structures)
Interface: Command-line interface (CLI)
Testing: pytest with 80% minimum coverage
```

**DO NOT**:
- Add persistence (no files, no database)
- Add web interface (no Flask, FastAPI, etc.)
- Add external dependencies beyond dev tools (pytest, mypy, ruff)
- Implement features beyond the 5 basic CRUD operations

### Article V: Feature Progression Discipline

**Basic Level (Phase I ONLY)**:
1. Add Task (title + optional description)
2. Delete Task (by ID)
3. Update Task (title/description by ID)
4. View Task List (all tasks with ID, title, desc, status)
5. Mark as Complete (toggle completion status by ID)

**OUT OF SCOPE for Phase I**:
- No priorities, tags, categories
- No due dates or reminders
- No search, filter, or sort
- No persistence
- No authentication

### Article VI: Code Quality & Architecture Standards

**Required**:
- âœ… Type hints for all functions and classes
- âœ… Docstrings (PEP 257) for all public functions
- âœ… PEP 8 compliance (enforced by ruff)
- âœ… Layered architecture: Model â†’ Service â†’ UI â†’ Main
- âœ… Pure functions in service layer (stateless)
- âœ… Single Responsibility Principle

**Validation Tools**:
```bash
uv run mypy src/todo_app --strict     # Type checking
uv run ruff check src/todo_app         # Linting
uv run pytest --cov=src/todo_app       # Testing + coverage
```

## Architecture Overview

### Layered Structure

```
User Input â†’ UI Layer â†’ Service Layer â†’ Model Layer â†’ In-Memory Storage
```

### File Organization

- **models.py**: Task dataclass + TaskList class (data structures)
- **services.py**: Pure functions for business logic (add, delete, update, toggle, get_all, find, validate)
- **ui.py**: CLI functions (menu, prompts, display, messages)
- **main.py**: Application orchestration (main loop, handlers)

### Key Design Decisions

1. **Dataclass for Task**: Type-safe, auto-generates `__init__`, `__repr__`, `__eq__`
2. **Pure Functions**: Service layer functions are stateless, accept/return data
3. **Sequential IDs**: Auto-increment starting from 1, gaps allowed after deletion
4. **No External CLI Framework**: Standard library only (no typer, click)
5. **Exit Warning**: Remind users data is not persisted

## Implementation Workflow

### Current Stage: Implementation (from tasks.md)

Execute tasks in order:
1. âœ… **Phase 1: Setup** (T001-T005) - Project structure, configs
2. âœ… **Phase 2: Foundational** (T006-T011) - Models, base tests
3. ðŸ”„ **Phase 3: US1 - Add & View** (T012-T033) - RED â†’ GREEN â†’ Integration
4. â³ **Phase 4: US2 - Mark Complete** (T034-T046) - RED â†’ GREEN â†’ Integration
5. â³ **Phase 5: US3 - Update** (T047-T056) - RED â†’ GREEN â†’ Integration
6. â³ **Phase 6: US4 - Delete** (T057-T064) - RED â†’ GREEN â†’ Integration
7. â³ **Phase 7: Polish** (T065-T092) - Edge cases, coverage, docs

### TDD Approach (RED-GREEN-REFACTOR)

For each user story:
1. **RED**: Write failing tests first
2. **GREEN**: Implement minimal code to pass tests
3. **REFACTOR**: Polish in Phase 7 (constants, error handling, docs)

### Task Execution Rules

- **Sequential tasks**: Complete in order within a phase
- **Parallel tasks [P]**: Can run concurrently (different files, no dependencies)
- **Checkpoint after each phase**: Validate before proceeding
- **Mark completed tasks**: Update tasks.md with `[X]` for completed tasks

## Testing Requirements

### Coverage Target

- **Minimum**: 80% (spec NFR-005)
- **Target**: 90%+ for critical paths
- **Measurement**: `uv run pytest --cov=src/todo_app --cov-report=term-missing`

### Test Organization

- **test_models.py**: Task dataclass, TaskList initialization
- **test_services.py**: All service functions (add, delete, update, toggle, get_all, find, validate)
- **test_ui.py**: UI functions (display, prompts) with mocked I/O
- **test_integration.py**: End-to-end workflows (add â†’ view â†’ update â†’ delete)
- **test_edge_cases.py**: Empty lists, invalid IDs, long text, unicode

### Test Fixtures (conftest.py)

```python
@pytest.fixture
def empty_task_list() -> TaskList:
    return TaskList(tasks=[], next_id=1)

@pytest.fixture
def task_list_with_data() -> TaskList:
    tl = TaskList(tasks=[], next_id=1)
    add_task(tl, "Task 1", "Description 1")
    add_task(tl, "Task 2", "Description 2")
    return tl
```

## Common Patterns

### Service Layer Functions

```python
def add_task(task_list: TaskList, title: str, description: str = "") -> Task | None:
    """Add a new task to the task list.

    Args:
        task_list: TaskList instance to add task to
        title: Task title (required, non-empty)
        description: Task description (optional)

    Returns:
        Created Task if successful, None if title invalid
    """
    if not validate_title(title):
        return None

    task = Task(
        id=task_list.next_id,
        title=title.strip(),
        description=description.strip(),
        completed=False
    )
    task_list.tasks.append(task)
    task_list.next_id += 1
    return task
```

### UI Layer Functions

```python
def display_tasks(tasks: List[Task]) -> None:
    """Display all tasks in a formatted table.

    Args:
        tasks: List of Task objects to display
    """
    if not tasks:
        print("No tasks found")
        return

    print(f"{'ID':<4} | {'Title':<20} | {'Description':<20} | {'Status':<15}")
    print("-" * 65)
    for task in tasks:
        status = "âœ“ Complete" if task.completed else "â—‹ Pending"
        print(f"{task.id:<4} | {task.title:<20} | {task.description:<20} | {status:<15}")
```

## Error Handling

### Input Validation (UI Layer)

- Loop until valid input received
- Try-except blocks for type conversion
- Clear error messages

### Business Validation (Service Layer)

- Return None or False on validation failure
- No exceptions for business logic errors
- UI layer interprets return values and displays messages

### Exception Handling (Main)

```python
def main() -> None:
    try:
        # main loop
    except KeyboardInterrupt:
        print("\n")
        display_exit_warning()
    except Exception as e:
        print(f"Unexpected error: {e}", file=sys.stderr)
```

## Git Commit Strategy

### When to Commit

- After each phase completion (Setup, Foundational, US1, US2, US3, US4, Polish)
- After all tests pass for a user story
- After significant milestones

### Commit Message Format

```
<type>: <subject>

<body>

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>
```

**Types**: feat (feature), fix (bug fix), test (tests), docs (documentation), refactor (code cleanup)

**Examples**:
- `feat: implement US1 - add and view tasks`
- `test: add service layer tests for US1`
- `docs: update README with usage instructions`

## Validation Checklist

Before marking Phase I complete:

- [ ] All 92 tasks in tasks.md marked as `[X]`
- [ ] All tests pass: `uv run pytest`
- [ ] Coverage â‰¥80%: `uv run pytest --cov`
- [ ] Type checking passes: `uv run mypy src/todo_app --strict`
- [ ] Linting passes: `uv run ruff check src/todo_app`
- [ ] All 5 CRUD features functional
- [ ] Manual test: Add, view, update, delete, mark complete
- [ ] Exit warning displays on quit
- [ ] README.md complete with setup/usage instructions
- [ ] Demo video created (90 seconds max)
- [ ] All files committed to GitHub main branch
- [ ] Git tag `v1.0-phase1` created and pushed

## Troubleshooting

### Tests Failing

1. Check imports: `from todo_app.models import Task, TaskList`
2. Verify fixtures in conftest.py
3. Run specific test: `uv run pytest tests/test_services.py::test_add_task_success -v`

### Type Errors (mypy)

1. Add type hints: `def func(param: int) -> str:`
2. Use `| None` for optional returns: `def func() -> Task | None:`
3. Import from typing if needed: `from typing import List`

### Linting Errors (ruff)

1. Auto-fix: `uv run ruff check src/todo_app --fix`
2. Check specific file: `uv run ruff check src/todo_app/services.py`

### Coverage Too Low

1. Identify uncovered lines: `uv run pytest --cov=src/todo_app --cov-report=term-missing`
2. Add tests for uncovered branches (if/else, try/except)
3. Focus on critical paths (add, view, update, delete, toggle)

## Next Steps After Phase I

1. Create demo video (90 seconds max, all 5 features)
2. Commit all code with meaningful messages
3. Tag: `git tag v1.0-phase1 && git push --tags`
4. Submit form: https://forms.gle/KMKEKaFUD6ZX4UtY8
5. Prepare for Phase II: Web interface with persistence

## Reference Documents

- **Specification**: `specs/phase-1/spec.md` (WHAT to build)
- **Architecture Plan**: `specs/phase-1/plan.md` (HOW to build)
- **Task Breakdown**: `specs/phase-1/tasks.md` (STEPS to execute)
- **Constitution**: `.specify/memory/constitution.md` (PROJECT GOVERNANCE)

---

**Remember**: No manual coding! All code AI-generated via Claude Code from specs.
